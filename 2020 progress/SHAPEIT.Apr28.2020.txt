# Can NOT get the pdf of this SHAPEIT paper
https://www.nature.com/articles/nmeth.1785
A linear complexity phasing method for thousands of genomes
Olivier Delaneau, Jonathan Marchini & Jean-François Zagury 
Nature Methods volume 9, pages179–181(2012)

https://www.nature.com/articles/nmeth.2307
Improved whole-chromosome phasing for disease and population genetic studies
Olivier Delaneau, Jean-Francois Zagury & Jonathan Marchini 
Nature Methods volume 10, pages5–6(2013

--------------------------------------------------------------------------
SHAPEIT (for genotype data) 
https://mathgen.stats.ox.ac.uk/genetics_software/shapeit/shapeit.html

##########
C51a.2008.ShapeIT.pdf
Shape-IT: new rapid and accurate algorithm for haplotype inferenceOlivier Delaneau, Cédric Coulonges and Jean-François Zagury*

##########
C51b.2012.Shapit.4genotype.pdf
A linear complexity phasing method for thousands of genomesOlivier Delaneau1,2, Jonathan Marchini2 & Jean-François Zagury1(1) We present a method for estimating haplotypes, using genotype data from unrelated samples or small nuclear families, that leads to improved accuracy and speed compared to several widely used methods. 
(2) The method, segmented haplotype estimation and imputation tool (SHAPEIT), scales linearly with the number of haplotypes used in each iteration and can be run efficiently on whole chromosomes.

4/28/2020 SS Reading summary:
SHAPIT is much faster than Phase2.1 (It is still developed for SNP data, 
 not for sequencing data) 

--------------------------------------------------------------------------

SHAPEIT2: 1st 2013 paper is the improved Shapeit1, and 2nd 2013 paper is for extending shapeit 2 to do HA for NGS data 
https://jmarchini.org/shapeit2/
SHAPEIT 2 – a program for accurate and efficient phasing of genetic datasets
##########
C51c.2013.Shapeit2.Improved.Shapeit1.pdf
Improved whole-chromosome phasing for disease and population genetic studies

(1) Here we present SHAPEIT2, a method that combines features of SHAPEIT1 and Impute2 (ref. 3) to substantially enhanceperformance. 
(2) We use the SHAPEIT1 Markov model that represents the space of haplotypes consistent with a given individual’s genotypes across a whole chromosome.
(3)  The transition probabilities of this model are estimated by applying the Impute2 ‘surrogate family’ phasing approach in local windows of size W.

##########
C51d.2013.Shapeit2.extend4SeqReads.pdf  
Haplotype Estimation Using Sequencing Reads
(1) We have extended the SHAPEIT2 method to use phase-informative sequencing reads to improve phasing accuracy. 
    Our model incorporates the read information in a probabilistic model through base quality scores within each read. 
(2) The method is primarily designed for high coverage sequence data or data sets that already have genotypes called. 
    One important application is phasing of single samples sequenced at high coverage for use in medical sequencing and studies of rare diseases. 
(3) Our method can also use existing panels of reference haplotypes. 
(4) We tested the method by using a mother-father-child trio sequenced at high-coverage by Illumina together with thelow-coverage sequence data from the 1000 Genomes Project (1000GP)
(5) We found that use of phase-informative reads increases the mean distance between switch errors by 22% from 274.4 kb to 328.6 kb. We also used male chromosome X haplotypes from the 1000GP samples to simulate sequencing reads with varying insert size, read length, and base error rate. 
(6) When using short 100 bp paired-end reads, we found that using mixtures of insert sizes produced the best results. 
   When using longer reads with high error rates (5–20 kb read with 4%–15% error per base), phasing performance was substantially improved.

##########
C51e.2014.SHAPEIT2.duoHMM
A General Approach for Haplotype Phasing across the Full Spectrum of Relatedness
(1) we have developed a general strategy for phasing cohorts with any level of implicit or explicit relatedness between individuals. 
(2) First SHAPEIT2 is run ignoring all explicit family information. We then apply a novel HMM method (duoHMM) to combine theSHAPEIT2 haplotypes with any family information to infer the inheritance pattern of each meiosis at all sites across eachchromosome. This allows the correction of switch errors, detection of recombination events and genotyping errors.


##########
C51f.2015.Hap.Reference.Panel.1000Genome
Integrating sequence and array data to create an improved 1000 Genomes Project haplotype reference panel

page 2: Here we present a new version of SHAPEIT2 that estimates haplotypes from GLs generated by low coverage sequencing data. In addition, our new method can also take advantage of SNP microarray genotypes on the same samples.

Abstract:(1) A major use of the 1000 Genomes Project (1000GP) data is genotype imputation in genome-wide association studies (GWAS). Here we develop a method to estimate haplotypes from low coverage sequencing data that can take advantage of SNP microarray genotypes on the same samples. 
(2) Firstly the SNP array data are phased in order to build a backbone (or ’scaffold’) of haplotypes across each chromosome. We then phase the sequence data ‘onto’ this haplotype scaffold. 
(3) This approach can take advantage of relatedness between sequenced and non-sequenced samples to improve accuracy. We use this method to create a new 1000GP haplotype reference set for use by the human genetic community. 
(4) Using a set of validation genotypes at SNP and biallelic indels we show that these haplotypes have lower genotype discordance and improved imputation performance into downstream GWAS samples, especially at low frequency variants.

--------------------------------------------------------------------------
SHAPEIT3
https://jmarchini.org/shapeit3/
SHAPEIT 3 – a program for accurate and efficient phasing of very large genetic datasets
Haplotype estimation for biobank scale datasets
SHAPEIT3 is a new version of the SHAPEIT algorithm designed specifically for phasing very large micro-array datasets. It was used to phase the 500,000 individuals as part of the UK Biobank dataset.

##########
SHAPEIT3 paper: 
C51g.2016.SHAPEIT3.pdf
Haplotype estimation for biobank scale datasets. Nature Genetics. 48, 817–820 (2016)

Abstract(1) The UK Biobank (UKB) has recently released genotypes on 152,328 individuals together with extensive phenotypic and lifestyle information. 
(2) We present a new phasing method SHAPEIT3 that can handle such biobank scale datasets and results in switch error rates as low as ~0.3%. 
(3) The method exhibits O(NlogN) scaling in sample size (N), enabling fast and accurate phasing of even larger cohorts.

--------------------------------------------------------------------------
SHAPEIT4
https://odelaneau.github.io/shapeit4/ or 
https://github.com/odelaneau/shapeit4

SHAPEIT4 is a fast and accurate method for estimation of haplotypes (aka phasing) for SNP array and high coverage sequencing data. The version 4 is a refactored and improved version of the SHAPEIT algorithm with multiple key additional features:

###########
SHAPEIT4 paper: 
C51h.2019.SHAPEIT4.pdf
Accurate, scalable and integrative haplotype estimation. Nat. Comm. 2019.
Abstract: 
(1) The number of human genomes being genotyped or sequenced increases exponentially andefficient haplotype estimation methods able to handle this amount of data are now required.(2) Here we present a method, SHAPEIT4, which substantially improves upon other methods toprocess large genotype and high coverage sequencing datasets. 
(3) It notably exhibits sub-linear running times with sample size, provides highly accurate haplotypes and allows integratingexternal phasing information such as large reference panels of haplotypes, collections of prephasedvariants and long sequencing reads. We provide SHAPEIT4 in an open source formatand demonstrate its performance in terms of accuracy and running times on two goldstandard datasets: the UK Biobank data and the Genome In A Bottle.


-----------------------------------------------------------------------------
# Other papers that compared with SHAPEIT 

##########
HAPI-UR (for genotype data) --> compared with Beagle, MaCH, IMPUTE2, and SHAPEIT
C51.other.2012.HAPI-UR.Shapeit.pdf
Phasing of Many Thousands of Genotyped SamplesAmy L. Williams,1,2,* Nick Patterson,2 Joseph Glessner,3 Hakon Hakonarson,3 and David Reich1,2

(1) we present HAPI-UR (haplotype inference for unrelated samples), an algorithm that is designed to handle unrelated and/or trio and duo family data,

(2) Using a data set with 16,353 samples, we compare HAPI-UR to Beagle, MaCH, IMPUTE2, and SHAPEIT and show that HAPI-UR runs 183 faster than all methods and has a lower switch-error rate than do other methods except for Beagle; with the use of consensus phasing, running HAPI-UR three times gives a slightly lower switch-error rate than Beagle does and is more than six times faster.

##########
Eagle2 - compared with SHAPEIT2C51.other.2017.Eagle2.vs.Shapeit2.pdf
Reference-based phasing using the Haplotype Reference Consortium panel
Abstract(1) Haplotype phasing is a fundamental problem in medical and population genetics. Phasing is generally performed via statistical phasing within a genotyped cohort, an approach that can attain high accuracy in very large cohorts but attains lower accuracy in smaller cohorts. 
(2) Here, we instead explore the paradigm of reference-based phasing. We introduce a new phasing algorithm, Eagle2, that attains high accuracy across a broad range of cohort sizes by efficiently leveraging information from large external reference panels (such as the Haplotype Reference Consortium, HRC) using a new data structure based on the positional Burrows-Wheeler transform. 
(3) We demonstrate that Eagle2 attains a ≈20x speedup and ≈10% increase in accuracy compared to reference-based phasing using SHAPEIT2. On European-ancestry samples, Eagle2 with the HRC panel achieves >2x the accuracy of 1000 Genomes-based phasing. Eagle2 is open source and freely available for HRC-based phasing via the Sanger Imputation Service and the Michigan Imputation Server.

##########
Compare Beagle, Findhap, FImpute, Impute2, and ShapeIt2 for haplotyping based on genotype data:
C51.other.2017.Compare.ShapeIt2.Beagle.Findhap.FImpute.Impute2.pdf
A comparison of different algorithms for phasing haplotypes using Holstein cattle genotypes and pedigree data

Abstract
(1) Phasing genotypes to haplotypes is becoming increasingly important due to its applications in thestudy of diseases, population and evolutionary genetics, imputation, and so on. 
(2) Several studies have focused on the development of computational methods that infer haplotype phase from population genotype data. The aim of this study was to compare phasing algorithms implemented in Beagle, Findhap, FImpute,Impute2, and ShapeIt2 software using 50k and 777k (HD) genotyping data. 
(3) Six scenarios were considered: no-parents, sire-progeny pairs, sire-dam-progeny trios, each with and without 
pedigree information in Holstein cattle.
(4) Algorithms were compared with respect to their phasing accuracy and computational efficiency. 
(5) In the studied population, Beagle and FImpute were more accurate than other phasing algorithms. Across scenarios,phasing accuracies for Beagle and FImpute were 99.49– 99.90% and 99.44–99.99% for 50k, respectively, and99.90–99.99% and 99.87–99.99% for HD, respectively. 
(6) Generally, FImpute resulted in higher accuracy when genotypic information of at least one parent was available.In the absence of parental genotypes and pedigree information, Beagle and Impute2 (with double the default number of states) were slightly more accurate than FImpute. 
(7) Findhap gave high phasing accuracy when parents’ genotypes and pedigree information were available. 
(8) In terms of computing time, Findhap wasthe fastest algorithm followed by FImpute. FImpute was 30 to 131, 87 to 786, 
and 353 to 1,400 times faster across scenarios than Beagle, ShapeIt2, and Impute2, respectively. 
(9) In summary, FImpute and Beagle were the most accurate phasing algorithms. Moreover, the low computational requirement of FImpute makes it an attractive algorithm for phasing genotypes of large livestock populations.



--------------------------------------------------------------------------
Reference from https://jmarchini.org/shapeit2/
The methods implemented in the SHAPEIT software are described in the following papers. Please cite one or more of these papers if you use our software in your study.

1. Delaneau, J. Marchini, JF. Zagury (2012) A linear complexity phasing method for thousands of genomes. Nat Methods. 9(2):179-81. doi: 10.1038/nmeth.1785 [LINK]

2. Delaneau, JF. Zagury, J. Marchini (2013) Improved whole chromosome phasing for disease and population genetic studies. Nat Methods. 10(1):5-6. doi: 10.1038/nmeth.2307 [LINK]

3. Delaneau, B. Howie, A. Cox, J-F. Zagury, J. Marchini (2013) Haplotype estimation using sequence reads. American Journal of Human Genetics 93 (4) 787-696 [LINK]

4. J. O’Connell, D. Gurdasani, O. Delaneau, et al. (2014) A general approach for haplotype phasing across the full spectrum of relatedness. PLoS Genetics [LINK]

5.. Delaneau, J. Marchini, The 1000 Genomes Project Consortium (2014) Integrating sequence and array data to create an improved 1000 Genomes Project haplotype reference panel. Nature Communications 5 3934 [LINK]

Question: Haplotype Phasing with Shapeit2
https://www.biostars.org/p/207388/

--------------------------------------------------------------------------
/Users/ssun/Desktop/Work/NGS.Hap.Apr21.2020/Papers/0.Comp.Paper/F3.C51.SHAPEIT.11.papers

C51.other.2012.HAPI-UR.Shapeit.pdf
C51.other.2017.Compare.ShapeIt2.Beagle.Findhap.FImpute.Impute2.pdf
C51.other.2017.Eagle2.vs.Shapeit2.pdf
C51a.2008.ShapeIT.pdf
C51b.2012.Shapit.4genotype.pdf
C51c.2013.Shapeit2.Improved.Shapeit1.pdf
C51d.2013.Shapeit2.extend4SeqReads.pdf
C51e.2014.SHAPEIT2.duoHMM.pdf
C51f.2015.Hap.Reference.Panel.1000Genome.pdf
C51g.2016.SHAPEIT3.pdf
C51h.2019.SHAPEIT4.pdf
SHAPEIT.Apr28.2020.txt
SHAPEIT.paper.from.Xiaoqing.Apr24.2020



